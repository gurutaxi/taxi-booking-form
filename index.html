<!-- Booking Form -->
<form class="form-container" id="taxiForm">
  <h2>Book a Taxi</h2>
  <label for="name">Name *</label>
  <input type="text" id="name" name="name" required />

  <label for="phone">Phone (Australia only) *</label>
  <input type="tel" id="phone" name="phone" pattern="^\+?61\s?\d{4}\s?\d{4}$|^0[2-478]\d{8}$" required placeholder="e.g. 0412345678 or +61412345678" />

  <label for="pickupDateTime">Pickup Date & Time *</label>
  <input type="datetime-local" id="pickupDateTime" name="pickupDateTime" required />

  <label for="pickupLocation">Pickup Location *</label>
  <input type="text" id="pickupLocation" name="pickupLocation" required />

  <label for="dropoffLocation">Dropoff Location</label>
  <input type="text" id="dropoffLocation" name="dropoffLocation" />

  <label for="email">Email (optional)</label>
  <input type="email" id="email" name="email" />

  <div class="g-recaptcha" data-sitekey="6Lcqq2IrAAAAAE-5NzRW-iyV3M-Gq71oyThTXUDq"></div>

  <button type="submit">Submit Booking</button>
</form>

<script>
  document.getElementById('taxiForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const recaptchaToken = grecaptcha.getResponse();
    if (!recaptchaToken) {
      alert('Please complete the reCAPTCHA.');
      return;
    }

    const fd = new FormData();
    fd.append('name', document.getElementById('name').value);
    fd.append('phone', document.getElementById('phone').value);
    fd.append('pickupDateTime', document.getElementById('pickupDateTime').value);
    fd.append('pickupLocation', document.getElementById('pickupLocation').value);
    fd.append('dropoffLocation', document.getElementById('dropoffLocation').value);
    fd.append('email', document.getElementById('email').value);
    fd.append('recaptcha', recaptchaToken);

    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycby46pswxPlZpboD9atysN7PKi1KCCf3jhCbOA_w-1dmMV5_imb0zQOa5S3UlIZZZdxf/exec', {
        method: 'POST',
        body: fd
      });

      const result = await response.json();
      if (result.status === 'success') {
        alert('✅ Booking confirmed!');
        document.getElementById('taxiForm').reset();
        grecaptcha.reset();
      } else {
        alert('❌ Something went wrong. Please try again.');
      }
    } catch (err) {
      console.error(err);
      alert('❌ Submission failed. Please try again later.');
    }
  });
</script>
